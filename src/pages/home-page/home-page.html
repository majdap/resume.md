<main>
	<div class="left-side">
		<app-header></app-header>
		@if (showBrowserNote()) {
		<div class="browser-warning">
			<span>
				Due to differences in font-rendering in browser engines, preview may
				be inconsistent on non‑Chromium browsers. For best results, use
				Chromium based browser.
			</span>
			<button (click)="dismissBrowserNote()" style="margin-left: 12px">
				Dismiss
			</button>
		</div>
		}
		<div class="button-container">
			<button (click)="toggleGlobalStyles()">{{globalStylesVisible() ? 'Hide' : 'Show'}} Document Styles</button>
			<!-- TODO: <button (click)="exportPdf()">Export PDF</button> -->
			<!-- TODO:  <button (click)="livePreview()">Live Preview</button> -->
		</div>

		<!-- Should this be a content-section? Or textarea here, since it exists only once for the whole document -->
		<!-- I think textarea here is fine, since the content-section component is coupled with the contentService -->
		@if(globalStylesVisible()) {
		<div class="global-styles">
			<form [formGroup]="globalStyleForm">
				<textarea formControlName="globalStyling">
				</textarea>
			</form>
		</div>}
		<div class="content-sections">
			@for (section of contentSections(); track section.id) {
			<app-content-section
				[id]="section.id"
				[content]="section.content"
				[styling]="section.styling"
			></app-content-section>
			}
			<div class="button-container">
				<button (click)="addSection()">Add New Content Section ➕</button>
							</div>
		</div>
	</div>
	<div class="right-side">
		<!-- In future we will have option to display more pages not single display -->
		@switch (previewMode()) {
		  @case ('iframe') {
		<app-iframe-preview></app-iframe-preview>
		} @case ('pdf') { @if (safePdfUrl()) {
		<iframe
			[src]="safePdfUrl()"
			style="width: 100%; height: 100%; border: 0"
		></iframe>
		} } }
	</div>
	<!-- Footer Component -->
</main>
